"use strict";!function(c){var n,d;function o(i){return(parseFloat(i.parents(".good_info").find(".price sub").html())*parseInt(i.parents(".good_info").find(".goodnum p input").val())).toFixed(2)}function s(){var n=0,t=0,e=0;c(".good_info:visible").each(function(i,o){c(o).find(".select input").prop("checked")&&(n+=parseInt(c(o).find(".goodnum p input").val()),e+=parseFloat(c(o).find(".price strong").html()))}),c(".good_info:visible").each(function(i,o){t+=parseInt(c(o).find(".goodnum p input").val())}),c(".allnum").find("em").html(n),c(".shopcar").find("em").html(t),c(".allprice i").html("￥"+e.toFixed(2))}cookie.get("cookiesid")&&cookie.get("cookienum")?(c(".cart_null").hide(),c(".cart_list").show(),n=cookie.get("cookiesid").split(","),d=cookie.get("cookienum").split(","),c.each(n,function(i,o){var t,e;t=n[i],e=d[i],c.ajax({url:"http://10.31.152.13/project/gulptest/php/alldata.php",dataType:"json"}).done(function(i){c.each(i,function(i,o){var n;t==o.sid&&((n=c(".good_info:hidden").clone(!0,!0)).find(".title img").attr("src",o.src),n.find(".title img").attr("sid",o.sid),n.find(".title span").html(o.title),n.find(".goodnum p input").val(e),n.find(".price strong").html((o.price*e).toFixed(2)),n.find(".price sub").html(o.price),n.css("display","block"),c("tbody").append(n),s())})})})):(c(".cart_null").show(),c(".cart_list").hide()),c(".goodnum input").on("input",function(){var i;""!=c(this).val()&&(i=c(this).val(),/^\d+$/g.test(i)||c(this).val(1),0==c(this).val()&&c(this).val(1),c(this).parents(".good_info").find(".price strong").html(o(c(this))),s(),a(c(this)))}),c(".goodnum .sub").on("click",function(){var i=c(this).parents(".good_info").find(".goodnum p input").val();--i<1&&(i=1),c(this).parents(".good_info").find(".goodnum p input").val(i),c(this).parents(".good_info").find(".price strong").html(o(c(this))),s(),a(c(this))}),c(".goodnum .add").on("click",function(){var i=c(this).parents(".good_info").find(".goodnum p input").val();i++,c(this).parents(".good_info").find(".goodnum p input").val(i),c(this).parents(".good_info").find(".price strong").html(o(c(this))),console.log(o(c(this))),s(),a(c(this))}),c(".allselect").on("change",function(){c(".good_info:visible").find(":checkbox").prop("checked",c(this).prop("checked")),c(".allselect").prop("checked",c(this).prop("checked")),s()});var i=c(".good_info:visible").find(":checkbox");c("tbody").on("change",i,function(){c(".good_info:visible").find(":checkbox").length===c(".good_info:visible").find("input:checked").size()?c(".allselect").prop("checked",!0):c(".allselect").prop("checked",!1),s()});var t=[],e=[];function l(){e=cookie.get("cookiesid")&&cookie.get("cookienum")?(t=cookie.get("cookiesid").split(","),cookie.get("cookienum").split(",")):(t=[],[])}function a(i){l();var o=i.parents(".good_info").find("img").attr("sid");e[c.inArray(o,t)]=i.parents(".good_info").find(".goodnum input").val(),cookie.set("cookienum",e,10)}function p(n,i){var t=-1;c.each(i,function(i,o){n===o&&(t=i)}),i.splice(t,1),e.splice(t,1),cookie.set("cookiesid",i,10),cookie.set("cookienum",e,10)}c(".del a").on("click",function(){l(),window.confirm("你确定要删除吗?")&&(c(this).parents(".good_info").remove(),p(c(this).parents(".good_info").find("img").attr("sid"),t),s())}),c(".alldel a").on("click",function(){l(),window.confirm("你确定要删除选中的商品吗?")&&(c(".good_info:visible").each(function(){c(this).find(":checkbox").is(":checked")&&(c(this).remove(),p(c(this).find("img").attr("sid"),t))}),s())})}(jQuery);